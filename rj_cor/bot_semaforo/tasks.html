<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>pipelines.rj_cor.bot_semaforo.tasks API documentation</title>
<meta name="description" content="Tasks for cor" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pipelines.rj_cor.bot_semaforo.tasks</code></h1>
</header>
<section id="section-intro">
<p>Tasks for cor</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-
&#34;&#34;&#34;
Tasks for cor
&#34;&#34;&#34;
from typing import List, Tuple
from datetime import datetime, timedelta

import basedosdados as bd
import pandas as pd
from prefect import task
import pytz

from pipelines.constants import constants
from pipelines.utils.utils import (
    get_vault_secret,
    send_telegram_message,
    smart_split,
)


@task(checkpoint=False, nout=2)
def get_token_and_group_id(secret_path: str) -&gt; Tuple[str, int]:
    &#34;&#34;&#34;
    Returns Telegram token and group ID from a secret file.
    &#34;&#34;&#34;
    secret = get_vault_secret(secret_path, client=None)
    return (
        secret[&#34;data&#34;][&#34;token&#34;].strip(),
        int(secret[&#34;data&#34;][&#34;group_id&#34;].strip()),
    )


@task(checkpoint=False)
def get_data() -&gt; pd.DataFrame:
    &#34;&#34;&#34;
    Returns the dataframe with the alerts.
    &#34;&#34;&#34;
    query = &#34;&#34;&#34;
    WITH semaforos AS (
    SELECT
    *,
    ST_BUFFER(geometry, 100) raio
    FROM `rj-escritorio-dev.transporte_rodoviario_cet.semaforos`),

    distinct_selection AS (
    SELECT
        DISTINCT ts,
        uuid
    FROM
        `rj-escritorio-dev.transporte_rodoviario_waze.alertas`
    WHERE
        type = &#39;HAZARD&#39;
        AND subtype=&#39;HAZARD_ON_ROAD_TRAFFIC_LIGHT_FAULT&#39;
        AND city = &#39;Rio de Janeiro&#39;
        AND DATE_DIFF(CURRENT_DATE(), CAST(ts as DATETIME), DAY) &lt; 1 ),
    intermediate_query AS (
        SELECT
        distinct_selection.*,
        original.street,
        original.geometry,
        original.number_thumbs_up,
        original.reliability
        FROM
        distinct_selection
        LEFT JOIN
        `rj-escritorio-dev.transporte_rodoviario_waze.alertas` AS original
        ON
        distinct_selection.ts = original.ts
        AND distinct_selection.uuid = original.uuid
        WHERE
        original.street IS NOT NULL
        AND original.city = &#34;Rio de Janeiro&#34;
        ORDER BY
        ts),
    clusters AS (
        SELECT
            *,
            -- epsilon: The epsilon that specifies the radius, measured in meters,
            -- around a core value. 10 20 50
            ST_CLUSTERDBSCAN(geometry, 50, 1) OVER () AS cluster_num,
            SAFE_CAST(FORMAT_DATE(&#39;%s&#39;, ts) AS INT64) AS ts_epoch,
        FROM intermediate_query),

    pontos_de_alertas AS (
    SELECT
        cluster_num,
        MAX(ts) as ts,
        MAX(uuid) as uuid,
        MAX(street) as street,
        SUM(
            CASE WHEN number_thumbs_up is not null then CAST(number_thumbs_up as FLOAT64) ELSE 0 END
        ) as number_thumbs_up,
        MAX(reliability) as reliability,
        MAX(ts_epoch) as ts_epoch,
        ST_CENTROID_AGG(geometry) centroid,
        COUNT(*) as number_cluster_alerts
    FROM clusters
    GROUP BY cluster_num
    ORDER BY cluster_num),

    alertas_no_raio AS (
    SELECT
    s.name,
    DATETIME(MIN(ts), &#39;America/Sao_Paulo&#39;) initial_ts,
    s.description,
    SUM(a.number_thumbs_up) sum_thumbs_up
    FROM semaforos as s
    INNER JOIN pontos_de_alertas as a
        ON ST_COVERS(s.raio, a.centroid)
    GROUP BY s.name, s.description)

    SELECT
    alertas_no_raio.*,
    ST_Y(geometry) semaforo_latitude,
    ST_X(geometry) semaforo_longitude
    FROM alertas_no_raio
    LEFT JOIN semaforos
        ON alertas_no_raio.name = semaforos.name
    ORDER BY initial_ts DESC
    &#34;&#34;&#34;
    return bd.read_sql(query=query, billing_project_id=&#34;rj-cor&#34;, from_file=True)


@task(checkpoint=False)
def format_message(dataframe: pd.DataFrame) -&gt; pd.Series:
    &#34;&#34;&#34;
    Formats the message before sending it.
    &#34;&#34;&#34;
    # Create a link for eath alert on google maps
    def map_link(dataframe: pd.DataFrame):
        url = (
            &#34;https://www.google.com/maps/search/?api=1&amp;query=&#34;
            + dataframe[&#34;semaforo_latitude&#34;].astype(str)
            + &#34;,&#34;
            + dataframe[&#34;semaforo_longitude&#34;].astype(str)
            + &#34;&amp;zoom=21&#34;
        )
        url = &#39;&lt;a href=&#34;&#39; + url + &#39;&#34;&gt;&#39; + dataframe[&#34;description&#34;] + &#34;&lt;/a&gt;&#34;
        return url

    def current_date_time():
        &#34;&#34;&#34;
        Gets current &#34;date and time&#34; and &#34;current date and time minus 1 hour in
        list [current, current_minus_1h]
        &#34;&#34;&#34;
        date_format = &#34;%Y-%m-%d %H:%M:%S&#34;
        current = datetime.strptime(
            datetime.now(pytz.timezone(&#34;America/Sao_Paulo&#34;)).strftime(date_format),
            date_format,
        )
        current_minus_1h = current - timedelta(minutes=60)
        return current_minus_1h, current

    # Builds all alert messages
    alert = None
    thumbs_up_emoji = &#34;\U0001F44D&#34;
    current_minus_1h, current = current_date_time()

    mask = (dataframe[&#34;initial_ts&#34;] &gt; current_minus_1h) &amp; (
        dataframe[&#34;initial_ts&#34;] &lt;= current
    )
    filered_alerts = dataframe[mask]
    if len(filered_alerts) &gt; 0:
        filered_alerts[&#34;url&#34;] = map_link(filered_alerts)
        filered_alerts[&#34;alert&#34;] = (
            filered_alerts[&#34;initial_ts&#34;].apply(lambda x: str(x)[11:16])
            + &#34; - &#34;
            + filered_alerts[&#34;name&#34;]
            + &#34; - &#34;
            + filered_alerts[&#34;url&#34;]
            + &#34; - &#34;
            + filered_alerts[&#34;sum_thumbs_up&#34;].astype(str)
            + thumbs_up_emoji
            + &#34;\n \n&#34;
        )
        alert = &#34;&#34;.join(filered_alerts[&#34;alert&#34;].tolist())

    traffic_light_emoji = &#34;\U0001F6A6&#34;
    msg_header = (
        traffic_light_emoji
        + &#34; CETRIO&#34;
        + &#34;\n \nALERTA WAZE - Semáforo quebrado - atualizado em &#34;
        + current.strftime(&#34;%Y-%m-%d %H:%M:%S&#34;)
        + &#34;\n&#34;
        + &#34;Alertas no período de: &#34;
        + current_minus_1h.strftime(&#34;%H:%M&#34;)
        + &#34; -&gt; &#34;
        + current.strftime(&#34;%H:%M&#34;)
        + &#34;\n \n&#34;
    )

    # Builds final message
    if alert:
        msg = msg_header + alert
    else:
        alert = &#34;Não foram encontrados alertas no período&#34; + &#34;\n \n&#34;
        msg = msg_header + alert

    return smart_split(
        text=msg,
        max_length=constants.TELEGRAM_MAX_MESSAGE_LENGTH.value,
        separator=&#34;\n&#34;,
    )


@task(checkpoint=False)
# pylint: disable=too-many-arguments
def send_messages(token: str, group_id: str, messages: List[str]) -&gt; None:
    &#34;&#34;&#34;
    Sends the alerts to the Telegram group.
    &#34;&#34;&#34;
    for message in messages:
        if message != &#34;&#34;:
            send_telegram_message(message=message, token=token, chat_id=group_id)

    url = (
        &#39;&lt;a href=&#34;https://datastudio.google.com/reporting/b2841cf6-dd1b-4700-b6a4-140495e93ff4&#34;&gt;&#39;
        + &#34;MAPA GERAL&lt;/a&gt;&#34;
    )
    send_telegram_message(message=url, token=token, chat_id=group_id)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="pipelines.rj_cor.bot_semaforo.tasks.format_message"><code class="name flex">
<span>def <span class="ident">format_message</span></span>(<span>dataframe: pandas.core.frame.DataFrame) ‑> pandas.core.series.Series</span>
</code></dt>
<dd>
<div class="desc"><p>Formats the message before sending it.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@task(checkpoint=False)
def format_message(dataframe: pd.DataFrame) -&gt; pd.Series:
    &#34;&#34;&#34;
    Formats the message before sending it.
    &#34;&#34;&#34;
    # Create a link for eath alert on google maps
    def map_link(dataframe: pd.DataFrame):
        url = (
            &#34;https://www.google.com/maps/search/?api=1&amp;query=&#34;
            + dataframe[&#34;semaforo_latitude&#34;].astype(str)
            + &#34;,&#34;
            + dataframe[&#34;semaforo_longitude&#34;].astype(str)
            + &#34;&amp;zoom=21&#34;
        )
        url = &#39;&lt;a href=&#34;&#39; + url + &#39;&#34;&gt;&#39; + dataframe[&#34;description&#34;] + &#34;&lt;/a&gt;&#34;
        return url

    def current_date_time():
        &#34;&#34;&#34;
        Gets current &#34;date and time&#34; and &#34;current date and time minus 1 hour in
        list [current, current_minus_1h]
        &#34;&#34;&#34;
        date_format = &#34;%Y-%m-%d %H:%M:%S&#34;
        current = datetime.strptime(
            datetime.now(pytz.timezone(&#34;America/Sao_Paulo&#34;)).strftime(date_format),
            date_format,
        )
        current_minus_1h = current - timedelta(minutes=60)
        return current_minus_1h, current

    # Builds all alert messages
    alert = None
    thumbs_up_emoji = &#34;\U0001F44D&#34;
    current_minus_1h, current = current_date_time()

    mask = (dataframe[&#34;initial_ts&#34;] &gt; current_minus_1h) &amp; (
        dataframe[&#34;initial_ts&#34;] &lt;= current
    )
    filered_alerts = dataframe[mask]
    if len(filered_alerts) &gt; 0:
        filered_alerts[&#34;url&#34;] = map_link(filered_alerts)
        filered_alerts[&#34;alert&#34;] = (
            filered_alerts[&#34;initial_ts&#34;].apply(lambda x: str(x)[11:16])
            + &#34; - &#34;
            + filered_alerts[&#34;name&#34;]
            + &#34; - &#34;
            + filered_alerts[&#34;url&#34;]
            + &#34; - &#34;
            + filered_alerts[&#34;sum_thumbs_up&#34;].astype(str)
            + thumbs_up_emoji
            + &#34;\n \n&#34;
        )
        alert = &#34;&#34;.join(filered_alerts[&#34;alert&#34;].tolist())

    traffic_light_emoji = &#34;\U0001F6A6&#34;
    msg_header = (
        traffic_light_emoji
        + &#34; CETRIO&#34;
        + &#34;\n \nALERTA WAZE - Semáforo quebrado - atualizado em &#34;
        + current.strftime(&#34;%Y-%m-%d %H:%M:%S&#34;)
        + &#34;\n&#34;
        + &#34;Alertas no período de: &#34;
        + current_minus_1h.strftime(&#34;%H:%M&#34;)
        + &#34; -&gt; &#34;
        + current.strftime(&#34;%H:%M&#34;)
        + &#34;\n \n&#34;
    )

    # Builds final message
    if alert:
        msg = msg_header + alert
    else:
        alert = &#34;Não foram encontrados alertas no período&#34; + &#34;\n \n&#34;
        msg = msg_header + alert

    return smart_split(
        text=msg,
        max_length=constants.TELEGRAM_MAX_MESSAGE_LENGTH.value,
        separator=&#34;\n&#34;,
    )</code></pre>
</details>
</dd>
<dt id="pipelines.rj_cor.bot_semaforo.tasks.get_data"><code class="name flex">
<span>def <span class="ident">get_data</span></span>(<span>) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the dataframe with the alerts.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@task(checkpoint=False)
def get_data() -&gt; pd.DataFrame:
    &#34;&#34;&#34;
    Returns the dataframe with the alerts.
    &#34;&#34;&#34;
    query = &#34;&#34;&#34;
    WITH semaforos AS (
    SELECT
    *,
    ST_BUFFER(geometry, 100) raio
    FROM `rj-escritorio-dev.transporte_rodoviario_cet.semaforos`),

    distinct_selection AS (
    SELECT
        DISTINCT ts,
        uuid
    FROM
        `rj-escritorio-dev.transporte_rodoviario_waze.alertas`
    WHERE
        type = &#39;HAZARD&#39;
        AND subtype=&#39;HAZARD_ON_ROAD_TRAFFIC_LIGHT_FAULT&#39;
        AND city = &#39;Rio de Janeiro&#39;
        AND DATE_DIFF(CURRENT_DATE(), CAST(ts as DATETIME), DAY) &lt; 1 ),
    intermediate_query AS (
        SELECT
        distinct_selection.*,
        original.street,
        original.geometry,
        original.number_thumbs_up,
        original.reliability
        FROM
        distinct_selection
        LEFT JOIN
        `rj-escritorio-dev.transporte_rodoviario_waze.alertas` AS original
        ON
        distinct_selection.ts = original.ts
        AND distinct_selection.uuid = original.uuid
        WHERE
        original.street IS NOT NULL
        AND original.city = &#34;Rio de Janeiro&#34;
        ORDER BY
        ts),
    clusters AS (
        SELECT
            *,
            -- epsilon: The epsilon that specifies the radius, measured in meters,
            -- around a core value. 10 20 50
            ST_CLUSTERDBSCAN(geometry, 50, 1) OVER () AS cluster_num,
            SAFE_CAST(FORMAT_DATE(&#39;%s&#39;, ts) AS INT64) AS ts_epoch,
        FROM intermediate_query),

    pontos_de_alertas AS (
    SELECT
        cluster_num,
        MAX(ts) as ts,
        MAX(uuid) as uuid,
        MAX(street) as street,
        SUM(
            CASE WHEN number_thumbs_up is not null then CAST(number_thumbs_up as FLOAT64) ELSE 0 END
        ) as number_thumbs_up,
        MAX(reliability) as reliability,
        MAX(ts_epoch) as ts_epoch,
        ST_CENTROID_AGG(geometry) centroid,
        COUNT(*) as number_cluster_alerts
    FROM clusters
    GROUP BY cluster_num
    ORDER BY cluster_num),

    alertas_no_raio AS (
    SELECT
    s.name,
    DATETIME(MIN(ts), &#39;America/Sao_Paulo&#39;) initial_ts,
    s.description,
    SUM(a.number_thumbs_up) sum_thumbs_up
    FROM semaforos as s
    INNER JOIN pontos_de_alertas as a
        ON ST_COVERS(s.raio, a.centroid)
    GROUP BY s.name, s.description)

    SELECT
    alertas_no_raio.*,
    ST_Y(geometry) semaforo_latitude,
    ST_X(geometry) semaforo_longitude
    FROM alertas_no_raio
    LEFT JOIN semaforos
        ON alertas_no_raio.name = semaforos.name
    ORDER BY initial_ts DESC
    &#34;&#34;&#34;
    return bd.read_sql(query=query, billing_project_id=&#34;rj-cor&#34;, from_file=True)</code></pre>
</details>
</dd>
<dt id="pipelines.rj_cor.bot_semaforo.tasks.get_token_and_group_id"><code class="name flex">
<span>def <span class="ident">get_token_and_group_id</span></span>(<span>secret_path: str) ‑> Tuple[str, int]</span>
</code></dt>
<dd>
<div class="desc"><p>Returns Telegram token and group ID from a secret file.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@task(checkpoint=False, nout=2)
def get_token_and_group_id(secret_path: str) -&gt; Tuple[str, int]:
    &#34;&#34;&#34;
    Returns Telegram token and group ID from a secret file.
    &#34;&#34;&#34;
    secret = get_vault_secret(secret_path, client=None)
    return (
        secret[&#34;data&#34;][&#34;token&#34;].strip(),
        int(secret[&#34;data&#34;][&#34;group_id&#34;].strip()),
    )</code></pre>
</details>
</dd>
<dt id="pipelines.rj_cor.bot_semaforo.tasks.send_messages"><code class="name flex">
<span>def <span class="ident">send_messages</span></span>(<span>token: str, group_id: str, messages: List[str]) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Sends the alerts to the Telegram group.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@task(checkpoint=False)
# pylint: disable=too-many-arguments
def send_messages(token: str, group_id: str, messages: List[str]) -&gt; None:
    &#34;&#34;&#34;
    Sends the alerts to the Telegram group.
    &#34;&#34;&#34;
    for message in messages:
        if message != &#34;&#34;:
            send_telegram_message(message=message, token=token, chat_id=group_id)

    url = (
        &#39;&lt;a href=&#34;https://datastudio.google.com/reporting/b2841cf6-dd1b-4700-b6a4-140495e93ff4&#34;&gt;&#39;
        + &#34;MAPA GERAL&lt;/a&gt;&#34;
    )
    send_telegram_message(message=url, token=token, chat_id=group_id)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<form>
<input id="lunr-search" name="q" placeholder="🔎 Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../../../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pipelines.rj_cor.bot_semaforo" href="index.html">pipelines.rj_cor.bot_semaforo</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="pipelines.rj_cor.bot_semaforo.tasks.format_message" href="#pipelines.rj_cor.bot_semaforo.tasks.format_message">format_message</a></code></li>
<li><code><a title="pipelines.rj_cor.bot_semaforo.tasks.get_data" href="#pipelines.rj_cor.bot_semaforo.tasks.get_data">get_data</a></code></li>
<li><code><a title="pipelines.rj_cor.bot_semaforo.tasks.get_token_and_group_id" href="#pipelines.rj_cor.bot_semaforo.tasks.get_token_and_group_id">get_token_and_group_id</a></code></li>
<li><code><a title="pipelines.rj_cor.bot_semaforo.tasks.send_messages" href="#pipelines.rj_cor.bot_semaforo.tasks.send_messages">send_messages</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>